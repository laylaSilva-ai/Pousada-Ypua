<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pousada Quinta do Ypuã</title>
    <script src="https://sdk.mercadopago.com/js/v2"></script>
</head>
<body>
    <h1>Dados de Pagamento</h1>

    <form id="paymentForm">
        <p><strong>*Campos obrigatórios*</strong></p>
        <h3>Dados para Pix</h3>

        <label for="valor-total">Valor Total:</label>
        <input type="text" id="valor-total" name="valor-total" readonly><br><br>

        <label for="codigo-pix">Código Pix:</label> 
        <input type="text" id="codigo-pix" name="codigo-pix" value="(48)99940-9732" readonly><br><br>

        <button type="button" onclick="copiarCodigoPix()">Copiar Código Pix</button><br>

        <button type="button" onclick="gerarPix()">Gerar Pagamento com Mercado Pago</button>
    </form>

    <div id="qrCodeContainer" style="display:none;">
        <h3>Escaneie o QR Code para pagar com Pix:</h3>
        <img id="qrCodeImage" src="" alt="QR Code do pagamento" />
    </div>

    <script>
        // Função que chama a API do Mercado Pago para criar uma preferência de pagamento
        function gerarPix() {
            // Chave pública do Mercado Pago
            const mp = new MercadoPago('YOUR_PUBLIC_KEY');

            // Criação de uma preferência de pagamento com Pix
            const preference = {
                items: [
                    {
                        title: 'Produto Teste',
                        quantity: 1,
                        unit_price: 100.0, // Preço do produto (em reais)
                    },
                ],
                payment_methods: {
                    excluded_payment_types: [{
                        id: 'ticket'  // Excluindo pagamento por boleto
                    }],
                    installments: 1, // Permitindo apenas uma parcela
                    default_payment_method: 'pix', // Definindo Pix como método de pagamento
                },
                back_urls: {
                    success: 'https://www.your-site.com/success',
                    failure: 'https://www.your-site.com/failure',
                    pending: 'https://www.your-site.com/pending',
                },
                auto_return: 'approved',
            };

            // Criar a preferência com o Mercado Pago
            mp.preferences.create(preference)
                .then(function(response) {
                    // Exibe o QR Code gerado pelo Mercado Pago
                    const qrCodeImage = document.getElementById('qrCodeImage');
                    const qrCodeContainer = document.getElementById('qrCodeContainer');
                    
                    qrCodeImage.src = response.response.qr_code;
                    qrCodeContainer.style.display = 'block'; // Exibe a seção do QR Code
                })
                .catch(function(error) {
                    console.error('Erro ao criar a preferência:', error);
                });
        }

        // Função para copiar o código Pix
        function copiarCodigoPix() {
            const codigoPix = document.getElementById("codigo-pix");
            codigoPix.select();
            document.execCommand("copy");
            alert("Código Pix copiado para a área de transferência!");
        }
    </script>
</body>
</html>

